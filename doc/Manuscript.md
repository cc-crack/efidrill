

**介绍**

Hi，Black Hat审查委员会的各位委员，很高兴能够有机会向如此优秀的会议投稿。因为这是我们的第一次投稿，所以我们录制了这个视频来展示我们的演讲风格。

**成果**

我们投稿的成果是我们开发的UEFI漏洞检测工具Efidrill，利用该工具，我们检测发现了十多个UEFI的0Day漏洞；同时，为了更好的吸引同行一同改进该工具，提高UEFI产品的安全性，我们想通过大会正式开源该工具。

**动机（Why）**

在我们多年基于污点追踪技术的软件漏洞挖掘经验中，我们发现，通过可达定义分析算法，可以在有限的开销内，对关键指令和关键数据进行定位。在已知的UEFI漏洞检测工具中，已经有静态分析工具efiXplorer，但是还没有公开的工具，能够基于数据流追踪分析的方法，自动化的检测发现UEFI中的安全漏洞。

**目标**

希望开发一款基于数据流追踪分析的UEFI漏洞检测分析工具，以验证是否能够发现更多、更深层次的UEFI漏洞。

**关键贡献**

**贡献1：**

**实现了针对UEFI的数据流追踪分析模块**，该模块分析由汇编转译的IR语言中的use-def变量对应关系，以及IR程序上下文来判断数据的传递路径，通过数据传递路径，判断数据是否可以被控制；**实现了数值分析模块**，通过判断CMP、XOR等特殊的汇编指令，分析一个变量可能的数值范围，用于判断一个变量在一个分支中是否被限制在指定的数值范围之内，这能够帮助发现存在脆弱性的代码。

**贡献2：**

基于前文的数据流追踪分析方法，我们可以对SMM外部输入的数据进行自动化的结构体类型重建，当进行模糊测试时，这些自动重建的结构体类型可以用于更好的发生种子生成。

**贡献3：**

利用前文的数据流追踪分析方法，开发了TOC-TOU、SMMOOB等7个插件，可用于检测UEFI中对应的7种类型脆弱性。其他人可以基于这些可继承的插件，继续扩展检测范围和对象。

**效果验证**

利用漏洞分析插件，检测发现出戴尔、Intel、华硕等多个厂家UEFI产品中的10余个0Day漏洞。

**未来改进计划**

我们计划在将来添加各种不同CPU架构的支持，并且进一步丰富我们的数值分析模块，最终实现一个更完善的针对UEFI产品的数据流分析工具。
