# Efidrill ——Automated Hunting UEFI Firmware Vulnerability through Data-Flow Analysis

## 0x01. UEFI漏洞的价值

这一章将通过UEFI后门“黑莲花”来说明挖掘UEFI的漏洞的重要性，并说明UEFI Rootkit可能造成的危害。

## 0x02 SMM介绍

这一章将介绍什么是SMM以及展示常见的针对SMM的攻击面

## 0x03 为什么我们要开发我们的工具

## 0x03-1 case study CVE-2022-21198

CVE-2022-21198漏洞分析
这一章将分析现有的静态分析工具诸如EFIFuzz，efiXplorer，UEFITool及其不足，并展示我们制作工具的动机。

## 0x04 我们的工具EFIDrill

这一章将正式介绍IDA插件EfiDrill，一款可以进行自动化静态数据流分析，变量数值预测，漏洞识别，结构体类型识别的IDA插件。

## 0x05 工具的效果验证

这一章将展示我们发现的多个0 day。

## 0x06 工具架构说明

这一章将展示工具的架构。

## 0x07可达定义分析算法分析数据传递路径

这一章将说明如何通过可达定义分析算法在有限的开销内快速分析数据在路径上的传递过程。

## 0x08 数据流分析模块的实现

这一章将说明如何通过上一章的分析的结果对UEFI固件进行数据流分析并对变量进行污点追踪。

## 0x09 SMM外部输入总结

这一章将针对SMM总结了常见的外部输入来源，并将它们作为数据分析最开始的污点

## 0x10 变量数值预测模块

这一章将介绍为什么需要数值预测模块并介绍如何实现数值预测模块

## 0x11 漏洞挖掘功能的实现

这一章将总体展示我们的漏洞挖掘插件，并说明如何对工具进行扩展。

## 0x12 SMRAM OOB漏洞挖掘功能

这一章将说明如何通过工具进行SMM OOB类型漏洞的挖掘并找到4个0day漏洞，接下来我们以1个漏洞作为demo进行分析。
1个case展示细节

## 0x13 TOCTOU漏洞挖掘功能

这一章将说明如何通过工具进行TOCTOU类型漏洞的挖掘并找到6个0day漏洞，接下来我们以1个漏洞作为demo进行分析。
1个case展示细节

## 0x14 callout漏洞挖掘功能

这一章将说明如何通过工具进行callout类型漏洞的挖掘并找到一个nday漏洞，接下来我们以这个漏洞作为demo进行分析。

## 0x15 Getvariable溢出漏洞挖掘功能

这一章将说明如何通过工具进行Getvariable溢出类型漏洞的挖掘并用并找到一个n day漏洞，接下来我们以这个漏洞作为demo进行分析。

## 0x16 MEMCOPY溢出 漏洞挖掘功能

这一章将说明如何通过工具进行MEMCOPY溢出类型漏洞的挖掘

## 0x17 函数指针的参数为外部输入类型脆弱性检测插件

这一章将说明如何通过工具对函数指针调用包含SMM外部数据的脆弱点进行识别并找到一个0day漏洞，接下来我们以这个漏洞作为demo进行分析。

## 0x18 SMM外部不可信数据存入全局变量类型脆弱性检测插件

这一章将说明如何通过工具对SMM全局变量包含SMM外部指针的脆弱点进行识别并找到2个0day漏洞，接下来我们将以1个漏洞作为demo进行分析。

## 0x19 漏洞挖掘功能的自动化测试结果

这一章将展示通过网络上获取的热门供应商的固件进行测试的结果。

## 0x20 自动化结构体类型识别功能

这一章将说明额外的功能，我们如何通过我们的工具对SMM外部输入进行自动化结构体类型分析。

## 0x21 将来的打算

这一章将说明现有可以改善的地方和将来改进的计划
